/*
 * ğŸŒ² é¢˜ç›®åç§°: P3366 ã€æ¨¡æ¿ã€‘æœ€å°ç”Ÿæˆæ ‘
 * ğŸ”— é¢˜ç›®æ¥æº: æ´›è°· (Luogu)
 * ğŸš€ ç®—æ³•æ ‡ç­¾: Kruskal / å¹¶æŸ¥é›† / å›¾è®º
 * #### æµ‹è¯•é“¾æ¥: https://www.luogu.com.cn/problem/P3366
 * ğŸ“ é¢˜ç›®æè¿°
 * ----------------------------------------------------
 * å¦‚é¢˜,ç»™å‡ºä¸€ä¸ªæ— å‘å›¾,æ±‚å‡ºæœ€å°ç”Ÿæˆæ ‘.
 * å¦‚æœè¯¥å›¾ä¸è¿é€š,åˆ™è¾“å‡º "orz".
 *
 * ğŸ“¥ è¾“å…¥æ ¼å¼
 * ----------------------------------------------------
 * 1. ç¬¬ä¸€è¡Œ:ä¸¤ä¸ªæ•´æ•° N, M (N ä¸ªç»“ç‚¹ï¼ŒM æ¡è¾¹)
 * 2. åç»­ M è¡Œ:æ¯è¡Œä¸‰ä¸ªæ•´æ•° Xi, Yi, Zi
 * (è¡¨ç¤ºæœ‰ä¸€æ¡é•¿åº¦ä¸º Zi çš„æ— å‘è¾¹è¿æ¥ç»“ç‚¹ Xi, Yi)
 *
 * ğŸ“¤ è¾“å‡ºæ ¼å¼
 * ----------------------------------------------------
 * âœ… è‹¥è¿é€š:è¾“å‡ºä¸€ä¸ªæ•´æ•°,è¡¨ç¤ºæœ€å°ç”Ÿæˆæ ‘çš„è¾¹æƒä¹‹å’Œ.
 * âŒ è‹¥ä¸è¿é€š:è¾“å‡º "orz".
 *
 * ğŸ§ æ ·ä¾‹æ•°æ®
 * ----------------------------------------------------
 * Input:                  Output:
 * 4 5                     7
 * 1 2 2
 * 1 3 2
 * 1 4 3
 * 2 3 4
 * 3 4 3
 *
 * ğŸ“Š æ•°æ®èŒƒå›´
 * ----------------------------------------------------
 * ğŸ”¹ N <= 5,000
 * ğŸ”¹ M <= 200,000
 * ğŸ”¹ Zi <= 10,000
 */

#include <stdio.h>   // ä½¿ç”¨printf()å’Œscanf()å‡½æ•°
#include <stdbool.h> // ä½¿ç”¨boolæ•°æ®ç±»å‹
#include <string.h>  // ä½¿ç”¨memset()å‡½æ•°

#define MAXN 5001   // ğŸ° æœ€å¤§èŠ‚ç‚¹æ•°
#define MAXM 400001 // ğŸŒ‰ æœ€å¤§è¾¹æ•° (æ— å‘è¾¹ x2,é˜²è¶Šç•Œ)
int n, m;           // ğŸ“Š è¯»å…¥æ•°æ®: n èŠ‚ç‚¹çš„ä¸ªæ•°, m æ¡æ— å‘è¾¹.

// ==========================================
// ğŸŒŸ é“¾å¼å‰å‘æ˜Ÿå»ºç«‹å›¾ (Graph Structure)
// ==========================================
int head[MAXN];   // ğŸš© å¤´æŒ‡é’ˆ
int next[MAXM];   // ğŸ”— ä¸‹ä¸€æ¡è¾¹
int to[MAXM];     // ğŸ¯ ç›®æ ‡èŠ‚ç‚¹
int weight[MAXM]; // âš–ï¸ è¾¹æƒ
int cnt = 1;      // ğŸ”¢ è¾¹çš„ç¼–å·è®¡æ•°å™¨

// ==========================================
// ğŸ“‰ å°æ ¹å † (Min Heap)
// ==========================================
int min_heap[MAXN][2]; // ğŸ“¦ [i][0]æ˜¯èŠ‚ç‚¹ç¼–å·, [i][1]æ˜¯æƒé‡
int heap_size;         // ğŸ“ å°æ ¹å †çš„å½“å‰å¤§å°

// ==========================================
// ğŸ—ºï¸ æ¨¡æ‹Ÿåå‘ç´¢å¼•è¡¨ (æ ¸å¿ƒä¼˜åŒ– Core Optimization)
// ==========================================
int where[MAXN];
// ğŸŒ‘ where[v] = -1 : è¡¨ç¤ºvè¿™ä¸ªèŠ‚ç‚¹,ä»æ¥æ²¡æœ‰è¿›å…¥è¿‡å †
// ğŸŒ• where[v] = -2 : è¡¨ç¤ºvè¿™ä¸ªèŠ‚ç‚¹,å·²ç»å¼¹å‡ºè¿‡äº† (å·²åŠ å…¥MST)
// ğŸ“ where[v] >= 0 : è¡¨ç¤ºvè¿™ä¸ªèŠ‚ç‚¹,åœ¨å †ä¸Šçš„ç´¢å¼•ä½ç½® (ç”¨äºå¿«é€Ÿå®šä½)

int nodeCnt; // ğŸš© å·²ç»å¤„ç†è¿‡çš„èŠ‚ç‚¹ (MSTä¸­çš„ç‚¹æ•°)
int u, w;    // ğŸ—‘ï¸ ä¸¤ä¸ªå…¨å±€å˜é‡ u w ä¸ºä¸‹é¢çš„pop()åšå‡†å¤‡.

// ------------------------------------------------- ğŸ› ï¸ å»ºå›¾å‡†å¤‡

void build()
{
    cnt = 1;                       // ğŸ”„ é“¾å¼å‰å‘æ˜Ÿè®¡æ•°é‡ç½®
    heap_size = 0;                 // ğŸ§¹ å †çš„å¤§å°æ¸…ç©º
    nodeCnt = 0;                   // 0ï¸âƒ£ å‘ç°çš„èŠ‚ç‚¹æ˜¯0
    memset(head, 0, sizeof(head)); // ğŸ§¼ é“¾å¼å‰å‘æ˜Ÿæ¸…ç©º
    for (int i = 0; i <= n; i++)   // ğŸ“ åˆå§‹åŒ–æ‰€æœ‰èŠ‚ç‚¹çŠ¶æ€
    {
        where[i] = -1; // ğŸŒ‘ é»˜è®¤è¿™äº›èŠ‚ç‚¹ä¸åœ¨å †ä¸Š.
    }
}

void addChainEdge(int u, int v, int w)
{
    next[cnt] = head[u]; // ğŸ”— æ¥ä¸Šå‰é©±
    to[cnt] = v;         // ğŸ¯ è®°å½•ç»ˆç‚¹
    weight[cnt] = w;     // âš–ï¸ è®°å½•æƒé‡
    head[u] = cnt;       // ğŸš© æ›´æ–°å¤´æŒ‡é’ˆ
    cnt++;               // â• ç¼–å·+1
}

// ------------------------------------------------- ğŸŒ² å°æ ¹å †æ“ä½œ

// ğŸ”„ äº¤æ¢å †ä¸­ i å’Œ j ä½ç½®çš„ä¿¡æ¯
void swap(int i, int j)
{
    // 1. ğŸ—ºï¸ äº¤æ¢whereæ•°ç»„ä¸­çš„ä¿¡æ¯ (åŒæ­¥æ›´æ–°ç´¢å¼•)
    int a = min_heap[i][0]; // èŠ‚ç‚¹ a
    int b = min_heap[j][0]; // èŠ‚ç‚¹ b
    where[a] = j;           // ğŸ“ æŠŠèŠ‚ç‚¹aåœ¨å°æ ¹å †ä¸­çš„ç´¢å¼•æ”¹æˆj
    where[b] = i;           // ğŸ“ æŠŠèŠ‚ç‚¹båœ¨å°æ ¹å †ä¸­çš„ç´¢å¼•æ”¹æˆi

    // 2. ğŸ“¦ äº¤æ¢å»å¾€çš„èŠ‚ç‚¹
    int temp_v = min_heap[i][0];
    min_heap[i][0] = min_heap[j][0];
    min_heap[j][0] = temp_v;

    // 3. âš–ï¸ äº¤æ¢æƒé‡
    int temp_w = min_heap[i][1];
    min_heap[i][1] = min_heap[j][1];
    min_heap[j][1] = temp_w;
}

// ğŸ”¼ ä¸Šæµ®æ“ä½œ: æƒé‡å˜å°|æˆ–è€…æ–°åŠ å…¥,å‘ä¸Šè°ƒæ•´
void heapInsert(int i)
{
    while (i > 0 && min_heap[i][1] < min_heap[(i - 1) / 2][1])
    {
        swap(i, (i - 1) / 2); // ğŸ”„ ä¸çˆ¶èŠ‚ç‚¹äº¤æ¢
        i = (i - 1) / 2;      // â˜ï¸ æŒ‡é’ˆä¸Šç§»
    }
}

// ğŸ”½ ä¸‹æ²‰æ“ä½œ: å †é¡¶å…ƒç´ å˜å¤§äº†,ä¸ºäº†ç»´æŒå°æ ¹å †çš„æ€§è´¨,éœ€è¦å‘ä¸‹è°ƒæ•´
void heapify()
{
    int i = 0;
    int l = 2 * i + 1;
    while (l < heap_size)
    {
        int best = ((l + 1 < heap_size) && (min_heap[l + 1][1] < min_heap[l][1])) ? l + 1 : l; // ğŸ‘€ é€‰å‡ºå·¦å³å­©å­ä¸­æƒé‡è¾ƒå°çš„

        best = min_heap[best][1] < min_heap[i][1] ? best : i; // âš–ï¸ æ¯”è¾ƒå­©å­å’Œå½“å‰èŠ‚ç‚¹ (æ³¨æ„å¸¦ä¸Š[1]æ¯”è¾ƒæƒé‡)

        if (best == i)
            break; // âœ… ä¸éœ€è¦è°ƒæ•´äº†

        swap(best, i); // ğŸ”„ äº¤æ¢
        i = best;
        l = i * 2 + 1;
    }
}

// ğŸ“¤ å¼¹å‡ºå †é¡¶æœ€å°å€¼
void pop()
{
    u = min_heap[0][0];   // ğŸ“ å¤´éƒ¨é‚£ä¸ªç‚¹è¦å»é‚£ä¸ªä½ç½®
    w = min_heap[0][1];   // âš–ï¸ å¯¹åº”çš„æƒé‡
    swap(0, --heap_size); // ğŸ”„ å †æœ€åä½ç½®çš„æ¶ˆæ¯å’Œ0ä½ç½®çš„æ¶ˆæ¯äº¤æ¢,size-1
    heapify();            // ğŸ”½ å‘ä¸‹è°ƒæ•´
    where[u] = -2;        // ğŸŒ• æ ‡è®°vè¿™ä¸ªèŠ‚ç‚¹å·²ç»å¼¹å‡ºè¿‡äº†
    nodeCnt++;            // ğŸ“ˆ å‘ç°çš„èŠ‚ç‚¹æ•°é‡++
}

// ğŸ“­ åˆ¤æ–­å †æ˜¯å¦ä¸ºç©º
bool isEmpty()
{
    return heap_size == 0;
}

// ------------------------------------------------- ğŸ§  ä¸»è¦é€»è¾‘

// ğŸš¦ å¤„ç†ç¼–å·ä¸ºeiçš„è¾¹
void addOrUpdateOrIgnore(int ei)
{
    int v = to[ei];     // ğŸ¯ å»å¾€vè¿™ä¸ªèŠ‚ç‚¹çš„
    int w = weight[ei]; // âš–ï¸ è¾¹çš„æƒé‡.

    // æƒ…å†µ1: ğŸŒ‘ vè¿™ä¸ªç‚¹ä»æ¥æ²¡æœ‰è¿›å…¥è¿‡å † -> å…¥å †
    if (where[v] == -1)
    {
        min_heap[heap_size][0] = v;
        min_heap[heap_size][1] = w;
        where[v] = heap_size++; // ğŸ“ è®°å½•ä½ç½®, heap_size++
        heapInsert(where[v]);   // ğŸ”¼ å †éœ€è¦å‘ä¸Šè°ƒæ•´
    }
    // æƒ…å†µ2: ğŸ“ vè¿™ä¸ªç‚¹å·²ç»åœ¨å †ä¸Šäº† -> å°è¯•æ›´æ–°
    else if (where[v] >= 0)
    {
        int cur_weight = min_heap[where[v]][1];             // ğŸ’¾ ä¹‹å‰å­˜å…¥çš„æƒé‡
        int min_weight = (w < cur_weight) ? w : cur_weight; // ğŸ“‰ å–æ›´å°çš„é‚£ä¸ª
        min_heap[where[v]][1] = min_weight;                 // âœï¸ æ›´æ–°æƒé‡
        heapInsert(where[v]);                               // ğŸ”¼ å‘ä¸Šè°ƒæ•´
    }
    // æƒ…å†µ3: ğŸŒ• where[v] == -2, ä¸ç”¨å¤„ç†
}

int prim()
{
    // ğŸ ä»1èŠ‚ç‚¹å‡ºå‘
    nodeCnt = 1;   // 1ï¸âƒ£ ç°åœ¨å·²ç»å‘ç°ä¸€ä¸ªèŠ‚ç‚¹äº†.
    where[1] = -2; // ğŸŒ• é»˜è®¤1èŠ‚ç‚¹ä¸éœ€è¦è¿›å †,å¤©ç„¶è®¤ä¸ºä»–å·²ç»è¸å‡ºè¿‡äº†

    // ğŸ” éå†å…³äº1çš„æ‰€æœ‰çš„è¾¹
    for (int ei = head[1]; ei > 0; ei = next[ei])
    {
        addOrUpdateOrIgnore(ei);
    }

    int ans = 0; // ğŸ’° ç´¯åŠ è¾¹çš„æƒé‡çš„å’Œ
    while (!isEmpty())
    {
        pop();    // ğŸ¤ å–å‡ºæœ€è¿‘çš„ç‚¹
        ans += w; // â• ç´¯åŠ æƒé‡

        // ğŸ“¡ æ‰«ææ–°ç‚¹çš„é‚»å±…
        for (int ei = head[u]; ei > 0; ei = next[ei])
        {
            addOrUpdateOrIgnore(ei);
        }
    }
    return ans;
}

int main()
{
    if (scanf("%d %d", &n, &m) != 2)
        return 0;

    build(); // ğŸ—ï¸ åˆå§‹åŒ–

    for (int i = 0; i < m; i++)
    {
        int u, v, w;
        scanf("%d %d %d", &u, &v, &w);
        addChainEdge(u, v, w); // ğŸ”— u->v å»ºç«‹ä¸€æ¡è¾¹,æƒé‡w
        addChainEdge(v, u, w); // ğŸ”— v->u å»ºç«‹ä¸€æ¡è¾¹,æƒé‡w
    }

    int ans = prim(); // ğŸƒ å¼€å§‹ç®—æ³•

    if (nodeCnt == n) // âœ… å¤„ç†çš„èŠ‚ç‚¹æ•°ç­‰äºn
        printf("%d", ans);
    else // âŒ ä¸å¤Ÿnä¸ªèŠ‚ç‚¹
        printf("orz\n");

    return 0;
}
