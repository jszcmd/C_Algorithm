// ğŸŒŸ é¢˜ç›®(5): é¢ å€’äºŒè¿›åˆ¶ä½ (Reverse Bits)
// ğŸ”— æµ‹è¯•é“¾æ¥: https://leetcode.cn/problems/reverse-bits/
// ğŸ§  æ ¸å¿ƒæ€æƒ³: åˆ†æ²»æ³• (Divide and Conquer).
//    å°±åƒå½’å¹¶æ’åºä¸€æ ·, å…ˆäº¤æ¢ç›¸é‚»çš„ 1 ä½, å†äº¤æ¢ç›¸é‚»çš„ 2 ä½, 4 ä½, 8 ä½...

#include <stdio.h>
#include <stdint.h> // å¼•å…¥ uint32_t æ ‡å‡†å¤´æ–‡ä»¶

/**
 * ğŸ› ï¸ é¢ å€’ 32 ä½æ— ç¬¦å·æ•´æ•°çš„äºŒè¿›åˆ¶ä½
 * @param n è¾“å…¥æ•´æ•°
 * @return  åè½¬åçš„æ•´æ•°
 */
uint32_t reverseBits(uint32_t n)
{
    // âš ï¸ æ³¨æ„: è¿™é‡Œç›´æ¥ä½¿ç”¨ uint32_t, é¿å…æœ‰ç¬¦å·æ•°å³ç§»å¸¦æ¥çš„ç¬¦å·ä½æ‰©å±•é—®é¢˜.

    // 1ï¸âƒ£ ç¬¬ä¸€æ­¥: 1ä½å¯¹1ä½äº¤æ¢ (ç›¸é‚»çš„ä¸¤ä½äº’æ¢)
    // 0x55555555 = 0101 0101 ... (æå–å¥‡æ•°ä½)
    // 0xAAAAAAAA = 1010 1010 ... (æå–å¶æ•°ä½)
    // é€»è¾‘: ((å¶æ•°ä½å³ç§»1) | (å¥‡æ•°ä½å·¦ç§»1))
    // æ•ˆæœ: ab cd ef gh -> ba dc fe hg
    n = ((n & 0xAAAAAAAA) >> 1) | ((n & 0x55555555) << 1);

    // 2ï¸âƒ£ ç¬¬äºŒæ­¥: 2ä½å¯¹2ä½äº¤æ¢ (å—å†…äº’æ¢)
    // 0x33333333 = 0011 0011 ... (æå–å—å†…çš„ä½2ä½)
    // 0xCCCCCCCC = 1100 1100 ... (æå–å—å†…çš„é«˜2ä½)
    // é€»è¾‘: ((é«˜2ä½å³ç§»2) | (ä½2ä½å·¦ç§»2))
    // æ•ˆæœ: ba dc fe hg -> dc ba hg fe
    n = ((n & 0xCCCCCCCC) >> 2) | ((n & 0x33333333) << 2);

    // 3ï¸âƒ£ ç¬¬ä¸‰æ­¥: 4ä½å¯¹4ä½äº¤æ¢ (åŠå­—èŠ‚äº’æ¢)
    // 0x0F0F0F0F = 0000 1111 ...
    // 0xF0F0F0F0 = 1111 0000 ...
    // æ•ˆæœ: dcba hgfe -> hgfe dcba
    n = ((n & 0xF0F0F0F0) >> 4) | ((n & 0x0F0F0F0F) << 4);

    // 4ï¸âƒ£ ç¬¬å››æ­¥: 8ä½å¯¹8ä½äº¤æ¢ (å­—èŠ‚äº’æ¢)
    // 0x00FF00FF = ... 00000000 11111111
    // 0xFF00FF00 = ... 11111111 00000000
    // æ•ˆæœ: å­—èŠ‚1 å­—èŠ‚2 å­—èŠ‚3 å­—èŠ‚4 -> å­—èŠ‚2 å­—èŠ‚1 å­—èŠ‚4 å­—èŠ‚3
    n = ((n & 0xFF00FF00) >> 8) | ((n & 0x00FF00FF) << 8);

    // 5ï¸âƒ£ ç¬¬äº”æ­¥: 16ä½å¯¹16ä½äº¤æ¢ (é«˜ä½åŠåŒºäº’æ¢)
    // æ­¤æ—¶ä¸éœ€è¦æ©ç äº†, å› ä¸º 32 ä½æ•°ç§»åŠ¨ 16 ä½ä¼šè‡ªåŠ¨æ¸…é™¤è¶Šç•Œéƒ¨åˆ†.
    // æ•ˆæœ: é«˜16ä½ <-> ä½16ä½
    n = (n >> 16) | (n << 16);

    return n;
}

int main()
{
    // æµ‹è¯•ç”¨ä¾‹: 43261596 (äºŒè¿›åˆ¶ 00000010100101000001111010011100)
    // é¢„æœŸç»“æœ: 964176192 (äºŒè¿›åˆ¶ 00111001011110000010100101000000)
    uint32_t n = 43261596;

    printf("Original: %u\n", n);
    printf("Reversed: %u\n", reverseBits(n));

    return 0;
}
