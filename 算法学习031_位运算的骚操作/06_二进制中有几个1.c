// ğŸŒŸ é¢˜ç›®(6): ç»Ÿè®¡ä¸€ä¸ªæ•°çš„äºŒè¿›åˆ¶ä¸­æœ‰å‡ ä¸ª 1 (Hamming Weight)
// ğŸ”— ç›¸å…³é¢˜ç›®: Hamming Distance (æ±‰æ˜è·ç¦») -> https://leetcode.cn/problems/hamming-distance/
// ğŸ§  æ ¸å¿ƒæ€æƒ³: å¹³è¡Œç®—æ³• (Parallel Algorithm) / åˆ†æ²»æ³•.
//    ä¸ä¸€ä¸ªä¸ªåœ°æ•°, è€Œæ˜¯å…ˆæŠŠç›¸é‚»çš„ä¸¤ä½åŠ èµ·æ¥, å†æŠŠç›¸é‚»çš„å››ä½åŠ èµ·æ¥... æœ€ç»ˆæ±‡æ€».

#include <stdio.h>

/**
 * ğŸ› ï¸ ç»Ÿè®¡ 32 ä½æ•´æ•°äºŒè¿›åˆ¶ä¸­ 1 çš„ä¸ªæ•°
 * @param n è¾“å…¥æ•´æ•°
 * @return  1 çš„ä¸ªæ•°
 */
int cntOnes(unsigned int n)
{
	// âš ï¸ æ³¨æ„: å¿…é¡»è½¬ä¸º unsigned int, é¿å…è´Ÿæ•°å³ç§»æ—¶ç¬¦å·ä½æ‰©å±•å¯¼è‡´è®¡ç®—é”™è¯¯.

	// 1ï¸âƒ£ ç¬¬ä¸€æ­¥: æ¯ 2 ä½ä¸€ç»„, ç»Ÿè®¡è¿™ 2 ä½é‡Œæœ‰å‡ ä¸ª 1
	// 0x55555555 = 0101 0101 ... (æå–å¥‡æ•°ä½)
	// é€»è¾‘: (å¶æ•°ä½çš„å€¼) + (å¥‡æ•°ä½çš„å€¼) -> å­˜å…¥è¿™ 2 ä½ä¸­
	// ä¾‹å­: 11 (äºŒè¿›åˆ¶) -> 1(å·¦è¾¹çš„1) + 1(å³è¾¹çš„1) = 10 (äºŒè¿›åˆ¶çš„2)
	n = (n & 0x55555555) + ((n >> 1) & 0x55555555);

	// 2ï¸âƒ£ ç¬¬äºŒæ­¥: æ¯ 4 ä½ä¸€ç»„, ç»Ÿè®¡è¿™ 4 ä½é‡Œæœ‰å‡ ä¸ª 1
	// 0x33333333 = 0011 0011 ... (æå–æ¯ç»„çš„ä½ 2 ä½)
	// æ­¤æ—¶ n çš„æ¯ 2 ä½å·²ç»å­˜å‚¨äº†è¿™ 2 ä½åŸæœ¬çš„ 1 çš„ä¸ªæ•°.
	// é€»è¾‘: (é«˜ 2 ä½çš„è®¡æ•°å€¼) + (ä½ 2 ä½çš„è®¡æ•°å€¼) -> å­˜å…¥è¿™ 4 ä½ä¸­
	n = (n & 0x33333333) + ((n >> 2) & 0x33333333);

	// 3ï¸âƒ£ ç¬¬ä¸‰æ­¥: æ¯ 8 ä½ä¸€ç»„ (åŠå­—èŠ‚), æ±‡æ€» 1 çš„ä¸ªæ•°
	// 0x0F0F0F0F = 0000 1111 ...
	n = (n & 0x0F0F0F0F) + ((n >> 4) & 0x0F0F0F0F);

	// 4ï¸âƒ£ ç¬¬å››æ­¥: æ¯ 16 ä½ä¸€ç»„ (å­—èŠ‚), æ±‡æ€»
	// 0x00FF00FF = 00000000 11111111 ...
	n = (n & 0x00FF00FF) + ((n >> 8) & 0x00FF00FF);

	// 5ï¸âƒ£ ç¬¬äº”æ­¥: å…¨å±€æ±‡æ€» (32 ä½), å¾—åˆ°æœ€ç»ˆç»“æœ
	// 0x0000FFFF = ... 00000000 00000000 11111111 11111111
	n = (n & 0x0000FFFF) + ((n >> 16) & 0x0000FFFF);

	return n;
}

/**
 * ğŸš€ LeetCode é¢˜ç›®: æ±‰æ˜è·ç¦»
 * ä¸¤ä¸ªæ•´æ•°ä¹‹é—´çš„æ±‰æ˜è·ç¦»æŒ‡çš„æ˜¯è¿™ä¸¤ä¸ªæ•°å­—å¯¹åº”äºŒè¿›åˆ¶ä½ä¸åŒçš„ä½ç½®çš„æ•°ç›®.
 * åŸç†: å¼‚æˆ– (^) æ“ä½œå¯ä»¥æ‰¾å‡ºä¸åŒçš„ä½(ç»“æœä¸º1), ç„¶åç»Ÿè®¡ 1 çš„ä¸ªæ•°å³å¯.
 */
int hammingDistance(int x, int y)
{
	return cntOnes(x ^ y);
}

int main()
{
	// ğŸ§ª æµ‹è¯•ç”¨ä¾‹
	int num = 114514; // äºŒè¿›åˆ¶: 0001 1011 1111 0101 0010 (å…±æœ‰ 10 ä¸ª 1)

	printf("Number: %d\n", num);
	printf("Count of 1s: %d\n", cntOnes(num));

	// æµ‹è¯•æ±‰æ˜è·ç¦»
	// 1 (0001) å’Œ 4 (0100) -> å¼‚æˆ–å 0101 -> 2ä¸ª1 -> è·ç¦»ä¸º 2
	printf("Hamming Distance (1, 4): %d\n", hammingDistance(1, 4));

	return 0;
}
