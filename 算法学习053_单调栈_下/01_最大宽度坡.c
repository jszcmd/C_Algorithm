/*
* ================================================================================
 * ğŸ“˜ é¢˜ç›®: æœ€å¤§å®½åº¦å¡ (Maximum Width Ramp)
 * ğŸ”— é¢˜ç›®é“¾æ¥: https://leetcode.cn/problems/maximum-width-ramp/
 * ================================================================================
 * éš¾åº¦:ä¸­ç­‰
 * æ ‡ç­¾:æ ˆ, æ•°ç»„, å•è°ƒæ ˆ
 *
 * ã€é¢˜ç›®æè¿°ã€‘
 * ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ A,å¡æ˜¯å…ƒç»„ (i, j),å…¶ä¸­  i < j ä¸” A[i] <= A[j].
 * è¿™æ ·çš„å¡çš„å®½åº¦ä¸º j - i.
 *
 * æ‰¾å‡º A ä¸­çš„å¡çš„æœ€å¤§å®½åº¦,å¦‚æœä¸å­˜åœ¨,è¿”å› 0 .
 *
 * --------------------------------------------------------------------------------
 * ğŸŒŸ ç¤ºä¾‹ 1:
 * è¾“å…¥:[6,0,8,2,1,5]
 * è¾“å‡º:4
 * è§£é‡Š:
 * æœ€å¤§å®½åº¦çš„å¡ä¸º (i, j) = (1, 5): A[1] = 0 ä¸” A[5] = 5.
 *
 * ğŸŒŸ ç¤ºä¾‹ 2:
 * è¾“å…¥:[9,8,1,0,1,9,4,0,4,1]
 * è¾“å‡º:7
 * è§£é‡Š:
 * æœ€å¤§å®½åº¦çš„å¡ä¸º (i, j) = (2, 9): A[2] = 1 ä¸” A[9] = 1.
 *
 * --------------------------------------------------------------------------------
 * ğŸ“ æç¤º (Constraints):
 * â€¢ 2 <= A.length <= 50000
 * â€¢ 0 <= A[i] <= 50000
 * ================================================================================
 */

#define MAX 50001 // é¢˜ç›®çš„æœ€å¤§æ•°æ®é‡

int stack[MAX] = {0}; // å•è°ƒæ ˆ(ä¸¥æ ¼å•è°ƒé€’å‡,å­˜æ”¾ä¸‹æ ‡)
int r = 0; // æ ˆé¡¶æŒ‡é’ˆ(è¡¨ç¤ºæ ˆå†…å…ƒç´ ä¸ªæ•°)

int maxWidthRamp(const int *nums, const int numsSize) {
    // åˆå§‹åŒ–: 0ä½ç½®å…ˆå…¥æ ˆ
    // stack[0] = 0; // æ˜¾å¼èµ‹å€¼æ›´å®‰å…¨(é»˜è®¤ç¬¬ä¸€ä¸ªæ˜¯è¿›æ ˆçš„)
    r = 1; // æ ˆå¤§å°å˜ä¸º1

    int n = numsSize;
    int i = 0;

    // ç¬¬ä¸€æ­¥: æ­£å‘éå†, æ„å»ºå•è°ƒé€’å‡æ ˆ
    // ç›®çš„: åªè®°å½•é‚£äº›"æ¯”ä¹‹å‰æ‰€æœ‰æ•°éƒ½å°"çš„ä¸‹æ ‡, ä½œä¸ºæ½œåœ¨çš„å¡åº•
    for (i = 1; i < n; i++) {
        if (nums[i] < nums[stack[r - 1]]) {
            // ä¸¥æ ¼å°äºæ ˆé¡¶æ‰å…¥æ ˆ
            stack[r++] = i; // ä¸‹æ ‡å…¥æ ˆ
        }
    }

    int ans = 0;
    // ç¬¬äºŒæ­¥: ä»å³å¾€å·¦éå†, è´ªå¿ƒè®¡ç®—æœ€å¤§å®½åº¦
    for (i = n - 1; i >= 0; i--) {
        // åªè¦å½“å‰æ•° >= æ ˆé¡¶å¯¹åº”çš„æ•°, å°±è¯´æ˜æ‰¾åˆ°äº†ä¸€ä¸ªå¡
        while (r > 0 && nums[i] >= nums[stack[r - 1]]) {
            // 1. è®¡ç®—å®½åº¦: å½“å‰ä½ç½® i - æ ˆé¡¶ä¸‹æ ‡
            // 2. å‡ºæ ˆ(--r): å› ä¸º i åœ¨ä¸æ–­å‡å°, è¿™ä¸ªæ ˆé¡¶å…ƒç´ èƒ½åŒ¹é…çš„æœ€å¤§å®½åº¦å°±æ˜¯ç°åœ¨, ä»¥åä¸ç”¨å†çœ‹äº†
            int width = i - stack[--r];
            // 3.æ›´æ–°æœ€å¤§å€¼
            ans = (ans > width) ? ans : width;
        }
    }
    return ans;
}
