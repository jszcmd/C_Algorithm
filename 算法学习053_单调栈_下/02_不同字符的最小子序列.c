// /*
// * ================================================================================
//  * ğŸ“˜ é¢˜ç›®: ä¸åŒå­—ç¬¦çš„æœ€å°å­åºåˆ— (Smallest Subsequence of Distinct Characters)
//  * ğŸ”— é¢˜ç›®é“¾æ¥: https://leetcode.cn/problems/smallest-subsequence-of-distinct-characters/
//  * ================================================================================
//  * éš¾åº¦:ä¸­ç­‰
//  * æ ‡ç­¾:æ ˆ, è´ªå¿ƒ, å­—ç¬¦ä¸², å•è°ƒæ ˆ
//  *
//  * ã€é¢˜ç›®æè¿°ã€‘
//  * è¿”å› s å­—å…¸åºæœ€å°çš„å­åºåˆ—,è¯¥å­åºåˆ—åŒ…å« s çš„æ‰€æœ‰ä¸åŒå­—ç¬¦,ä¸”åªåŒ…å«ä¸€æ¬¡ã€‚
//  *
//  * --------------------------------------------------------------------------------
//  * ğŸŒŸ ç¤ºä¾‹ 1:
//  * è¾“å…¥:s = "bcabc"
//  * è¾“å‡º:"abc"
//  *
//  * ğŸŒŸ ç¤ºä¾‹ 2:
//  * è¾“å…¥:s = "cbacdcbc"
//  * è¾“å‡º:"acdb"
//  *
//  * --------------------------------------------------------------------------------
//  * ğŸ“ æç¤º (Constraints):
//  * â€¢ 1 <= s.length <= 1000
//  * â€¢ s ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ
//  * ================================================================================
//  */


#include <stdbool.h> // ä½¿ç”¨boolç±»å‹
#include <string.h> // ä½¿ç”¨strlenå’Œmemset
#include <stdlib.h> // ä½¿ç”¨malloc

// è¿™é“é¢˜åªä¼šå‡ºç°å°å†™å­—ç¬¦
int cnts[26] = {0}; // å‰©ä½™å­—ç¬¦å‡ºç°æ¬¡æ•°ç»Ÿè®¡
// açš„å‡ºç°çš„æ¬¡æ•°å­˜åˆ°0  bçš„å‡ºç°çš„ä¿¡æ¯å­˜åˆ°1ä½ç½® ...

// æ ‡è®°æ¯ä¸€ä¸ªå­—ç¬¦æ˜¯å¦å­˜å…¥åœ¨æ ˆä¸­.
bool enter[26] = {false}; // æ ˆå†…å­˜åœ¨æ ‡è®°(ç”¨äºå»é‡)

// å•è°ƒæ ˆ
char stack[26] = {0};
int r = 0; // æ ˆé¡¶æŒ‡é’ˆ(ä»£è¡¨æ ˆä¸­å…ƒç´ ä¸ªæ•°)

char *smallestSubsequence(char *s) {
    r = 0; // é‡ç½®æ ˆé¡¶
    memset(cnts, 0, sizeof(cnts)); // é‡ç½®è®¡æ•°æ•°ç»„
    memset(enter, false, sizeof(enter)); // é‡ç½®æ ‡è®°æ•°ç»„
    // è·å–å­—ç¬¦ä¸²çš„é•¿åº¦
    int n = (int) strlen(s);
    int i = 0;
    // ç¬¬ä¸€æ­¥:è¯é¢‘ç»Ÿè®¡
    for (i = 0; i < n; i++) {
        cnts[s[i] - 'a']++; // ç»Ÿè®¡æ€»å‡ºç°æ¬¡æ•°
    }
    // ç¬¬äºŒæ­¥:æ„å»ºå•è°ƒæ ˆ
    // ä»å·¦å¾€å³è¾¹ä¾æ¬¡éå†å­—ç¬¦ä¸²s (æ³¨: ä»£ç é€»è¾‘æ˜¯iä»0åˆ°n, å®é™…ä¸Šæ˜¯ä»å·¦å¾€å³)
    for (i = 0; i < n; i++) {
        char cur = s[i]; // å½“å‰éå†åˆ°çš„å­—ç¬¦
        // å¦‚æœå½“å‰çš„å­—ç¬¦æ²¡æœ‰å‡ºç°åœ¨æ ˆé‡Œé¢,æ‰å»è€ƒè™‘
        // å¦‚æœå·²ç»åœ¨æ ˆä¸­,è¯´æ˜ä¹‹å‰å·²ç»ä¿ç•™äº†è¯¥å­—ç¬¦,è·³è¿‡å³å¯(ä¿è¯å»é‡)
        if (!enter[cur - 'a']) {
            // [æ ¸å¿ƒé€»è¾‘] ç»´æŠ¤å­—å…¸åºæœ€å°çš„å•è°ƒæ ˆ
            // å¼¹å‡ºéœ€åŒæ—¶æ»¡è¶³: 1.æ ˆä¸ç©º 2.æ ˆé¡¶>å½“å‰(æ¯”è¾ƒASCIIç ) 3.æ ˆé¡¶å­—ç¬¦åé¢è¿˜æœ‰(cnts>0)
            while ((r > 0) && (stack[r - 1] > cur) && (cnts[stack[r - 1] - 'a'] > 0)) {
                enter[stack[r - 1] - 'a'] = false; // æ ‡è®°å‡ºæ ˆ(çŠ¶æ€å¤åŸ)
                r--; // ç‰©ç†å¼¹å‡º
            }
            stack[r++] = cur; // å½“å‰å­—ç¬¦å…¥æ ˆ
            enter[cur - 'a'] = true; // æ ‡è®°å·²åœ¨æ ˆä¸­
        }
        cnts[cur - 'a']--; // å…³é”®: æ— è®ºæ˜¯å¦å…¥æ ˆ, å‰©ä½™æ¬¡æ•°å¿…-1
    }
    // ç”³è¯·è¶³å¤Ÿé•¿çš„ç©ºé—´,æŠŠåˆå¹¶å¥½ä»¥åçš„å­—ç¬¦ä¸²è¿”å›å‡ºå»
    char *str = (char *) malloc(sizeof(char) * (r + 1));
    for (i = 0; i < r; i++) {
        str[i] = stack[i]; // å¤åˆ¶ç»“æœ
    }
    str[r] = '\0'; // è¡¥ä¸Šç»“æŸç¬¦
    return str;
}
