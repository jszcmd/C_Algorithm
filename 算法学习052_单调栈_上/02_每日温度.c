/*
* ================================================================================
 * ğŸ“˜ é¢˜ç›®: æ¯æ—¥æ¸©åº¦ (Daily Temperatures)
 * ğŸ”— é¢˜ç›®é“¾æ¥: https://leetcode.cn/problems/daily-temperatures/
 * ================================================================================
 * éš¾åº¦:ä¸­ç­‰
 * æ ‡ç­¾:æ ˆ, æ•°ç»„, å•è°ƒæ ˆ
 *
 * ã€é¢˜ç›®æè¿°ã€‘
 * ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ temperatures ,è¡¨ç¤ºæ¯å¤©çš„æ¸©åº¦,è¿”å›ä¸€ä¸ªæ•°ç»„ answer ,
 * å…¶ä¸­ answer[i] æ˜¯æŒ‡å¯¹äºç¬¬ i å¤©,ä¸‹ä¸€ä¸ªæ›´é«˜æ¸©åº¦å‡ºç°åœ¨å‡ å¤©å.
 * å¦‚æœæ°”æ¸©åœ¨è¿™ä¹‹åéƒ½ä¸ä¼šå‡é«˜,è¯·åœ¨è¯¥ä½ç½®ç”¨ 0 æ¥ä»£æ›¿.
 *
 * --------------------------------------------------------------------------------
 * ğŸŒŸ ç¤ºä¾‹ 1:
 * è¾“å…¥: temperatures = [73,74,75,71,69,72,76,73]
 * è¾“å‡º: [1,1,4,2,1,1,0,0]
 *
 * ğŸŒŸ ç¤ºä¾‹ 2:
 * è¾“å…¥: temperatures = [30,40,50,60]
 * è¾“å‡º: [1,1,1,0]
 *
 * ğŸŒŸ ç¤ºä¾‹ 3:
 * è¾“å…¥: temperatures = [30,60,90]
 * è¾“å‡º: [1,1,0]
 *
 * --------------------------------------------------------------------------------
 * ğŸ“ æç¤º (Constraints):
 * â€¢ 1 <= temperatures.length <= 10^5
 * â€¢ 30 <= temperatures[i] <= 100
 * ================================================================================
 */


#include <stdlib.h> // ä½¿ç”¨callocå‡½æ•°
#define MAX 100001

int stack[MAX] = {0}; // å•è°ƒæ ˆ (å­˜ä¸‹æ ‡, å¯¹åº”æ¸©åº¦å•è°ƒé€’å‡)
int r = 0; // æ ˆé¡¶æŒ‡é’ˆ (è¡¨ç¤ºæ ˆå†…å…ƒç´ ä¸ªæ•°)

int *dailyTemperatures(const int *temperatures, const int temperaturesSize, int *returnSize) {
    const int n = temperaturesSize;
    *returnSize = n; // è®¾å®šè¿”å›æ•°ç»„é•¿åº¦
    r = 0; // é‡ç½®æ ˆ

    // ä½¿ç”¨ calloc ç”³è¯·å¹¶åˆå§‹åŒ–ä¸º0
    // è¿™ä¸€ç‚¹å¾ˆå…³é”®: å¦‚æœå…ƒç´ æœ€åç•™åœ¨æ ˆé‡Œæ²¡è¢«å¼¹å‡º, è¯´æ˜åé¢æ²¡æœ‰æ›´é«˜æ¸©, ç­”æ¡ˆé»˜è®¤ä¸º0
    int *ans = (int *) calloc(n, sizeof(int));

    int i = 0, cur = 0;
    // éå†æ¯ä¸€å¤©
    for (i = 0; i < n; i++) {
        // [æ ¸å¿ƒé€»è¾‘] ç»´æŠ¤å•è°ƒé€’å‡æ ˆ
        // åªè¦å½“å‰æ¸©åº¦ > æ ˆé¡¶é‚£å¤©çš„æ¸©åº¦, è¯´æ˜æ‰¾åˆ°äº†æ ˆé¡¶é‚£å¤©çš„"å‡æ¸©æ—¥"
        while (r > 0 && temperatures[i] > temperatures[stack[r - 1]]) {
            cur = stack[--r]; // å¼¹å‡ºæ ˆé¡¶ä¸‹æ ‡
            ans[cur] = i - cur; // è®¡ç®—è·ç¦» (å½“å‰å¤© - è¿‡å»é‚£å¤©)
        }

        stack[r++] = i; // å½“å‰å¤©å…¥æ ˆ, ç­‰å¾…æœªæ¥æ›´é«˜æ¸©
    }
    return ans;
}
