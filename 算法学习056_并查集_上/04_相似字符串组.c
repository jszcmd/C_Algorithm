/*
 * ================================================================================
 * ğŸ“˜ é¢˜ç›®: 839. ç›¸ä¼¼å­—ç¬¦ä¸²ç»„ (Similar String Groups)
 * ğŸ”— é“¾æ¥: https://leetcode.cn/problems/similar-string-groups/
 * ğŸ“ˆ éš¾åº¦: å›°éš¾ (Hard)
 * --------------------------------------------------------------------------------
 * ğŸ“ ã€é¢˜ç›®æè¿°ã€‘
 * å¦‚æœäº¤æ¢å­—ç¬¦ä¸² X ä¸­çš„ä¸¤ä¸ªä¸åŒä½ç½®çš„å­—æ¯,ä½¿å¾—å®ƒå’Œå­—ç¬¦ä¸² Y ç›¸ç­‰,é‚£ä¹ˆ X å’Œ Y ç›¸ä¼¼.
 * å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²æœ¬èº«å°±æ˜¯ç›¸ç­‰çš„,é‚£å®ƒä»¬ä¹Ÿæ˜¯ç›¸ä¼¼çš„.
 * ä¾‹å¦‚,"tars" å’Œ "rats" æ˜¯ç›¸ä¼¼çš„ (äº¤æ¢ 0 ä¸ 2 ä½);"rats" å’Œ "arts" ä¹Ÿæ˜¯ç›¸ä¼¼çš„.
 * æˆ‘ä»¬æŠŠç›¸ä¼¼æ€§å½¢æˆå…³è”ç»„.ç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ strs,æ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯å…¶ä»–å­—ç¬¦ä¸²çš„ä¸€ä¸ªå­—æ¯å¼‚ä½è¯.
 * è¯·é—® strs ä¸­æœ‰å¤šå°‘ä¸ªç›¸ä¼¼å­—ç¬¦ä¸²ç»„?
 * --------------------------------------------------------------------------------
 * ğŸŒŸ ã€ç¤ºä¾‹ 1ã€‘
 * è¾“å…¥:strs = ["tars","rats","arts","star"] -> è¾“å‡º:2
 * ğŸŒŸ ã€ç¤ºä¾‹ 2ã€‘
 * è¾“å…¥:strs = ["omv","ovm"] -> è¾“å‡º:1
 * --------------------------------------------------------------------------------
 * ğŸ“ ã€æç¤ºã€‘
 * â€¢ 1 <= strs.length <= 300
 * â€¢ 1 <= strs[i].length <= 300
 * â€¢ strs[i] åªåŒ…å«å°å†™å­—æ¯,ä¸”æ‰€æœ‰å•è¯å…·æœ‰ç›¸åŒçš„é•¿åº¦.
 * ================================================================================
 */

#include <string.h> // ä½¿ç”¨strlen()å‡½æ•°

#define MAX 301

int father[MAX]; // ğŸŒ³ å¹¶æŸ¥é›†çˆ¶èŠ‚ç‚¹æ•°ç»„
int sets;        // ğŸ”¢ è®°å½•å½“å‰çš„ç›¸ä¼¼ç»„æ€»æ•°

void build(int n)
{
    for (int i = 0; i < n; i++)
    {
        father[i] = i; // ğŸ åˆå§‹æ—¶æ¯ä¸ªèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹æŒ‡å‘è‡ªå·±
    }
    sets = n; // ğŸ”¢ åˆå§‹æ—¶æ¯ä¸ªå­—ç¬¦ä¸²ç‹¬ç«‹æˆç»„
}

int find(int i)
{
    if (i != father[i])
    {
        father[i] = find(father[i]); // âš¡ è·¯å¾„å‹ç¼©:å›æº¯æ—¶ç›´æ¥æŒ‚åœ¨æ ¹èŠ‚ç‚¹ä¸‹
    }
    return father[i];
}

void do_union(int x, int y)
{
    int fx = find(x); // ğŸ•µï¸ å¯»æ‰¾ x çš„æ ¹èŠ‚ç‚¹
    int fy = find(y); // ğŸ•µï¸ å¯»æ‰¾ y çš„æ ¹èŠ‚ç‚¹
    if (fx != fy)
    {
        father[fx] = fy; // ğŸ”— çœŸæ­£åˆå¹¶ä¸¤ä¸ªä¸åŒçš„ç›¸ä¼¼ç»„
        sets--;          // âœ… ç»„æ•°é€’å‡
    }
}

int numSimilarGroups(char **strs, int strsSize)
{
    int n = strsSize;        // ğŸ“ èŠ‚ç‚¹æ€»æ•°
    int m = strlen(strs[0]); // ğŸ“ å­—ç¬¦ä¸²å›ºå®šé•¿åº¦
    build(n);                // ğŸ—ï¸ åˆå§‹åŒ–å¹¶æŸ¥é›†

    for (int i = 0; i < n; i++)
    {
        for (int j = i + 1; j < n; j++)
        {
            if (find(i) != find(j)) // ğŸ’¡ æ ¸å¿ƒä¼˜åŒ–:å·²åœ¨åŒç»„åˆ™è·³è¿‡æ¯”å¯¹
            {
                int diff = 0; // ğŸ§ ç»Ÿè®¡å­—ç¬¦ä¸åŒçš„ä½ç½®æ•°
                for (int k = 0; k < m && diff < 3; k++)
                {
                    if (strs[i][k] != strs[j][k])
                    {
                        diff++; // ğŸš© è®°å½•ä¸€æ¬¡å·®å¼‚
                    }
                }
                if (diff == 0 || diff == 2) // âœ… ç›¸ä¼¼:ç›¸ç­‰æˆ–äº¤æ¢ä¸€æ¬¡å¯å˜ç›¸åŒ
                {
                    do_union(i, j); // ğŸ¤ æ‰§è¡Œåˆå¹¶
                }
            }
        }
    }
    return sets; // ğŸ¯ è¿”å›æœ€ç»ˆç›¸ä¼¼ç»„çš„æ•°é‡
}
